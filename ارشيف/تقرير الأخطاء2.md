# ğŸ“‹ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙˆØ§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª - Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© (Ø§Ù„ØªÙƒÙ…ÙŠÙ„ÙŠ)

**ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø±ÙŠØ±:** 29 Ø³Ø¨ØªÙ…Ø¨Ø± 2025
**Ø§Ù„Ù…Ø´Ø±ÙˆØ¹:** Ù…Ù†ØµØ© Ø´Ù…ÙˆØ® Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© v3
**Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù„Ø³Ø©:** Ø±Ø¨Ø· Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª + Ø§ÙƒØªØ´Ø§Ù Ø£Ø®Ø·Ø§Ø¡ Ø¬Ø¯ÙŠØ¯Ø©
**Ø§Ù„Ù…Ø¯Ø©:** ~2 Ø³Ø§Ø¹Ø§Øª
**Ù…ÙƒÙ…Ù„ Ù„Ù€:** ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø®Ø·Ø§Ø¡1.md

---

## ğŸ¯ Ù…Ù„Ø®Øµ Ø§Ù„Ø¬Ù„Ø³Ø©

ØªÙ… ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø¬Ù„Ø³Ø© **Ø¥ÙƒÙ…Ø§Ù„ Ø±Ø¨Ø· Ø¬Ù…ÙŠØ¹ ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª** ÙˆØ§ÙƒØªØ´Ø§Ù **6 Ø£Ø³Ø¨Ø§Ø¨ Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø£Ø®Ø·Ø§Ø¡** Ù„Ù… ØªÙØ°ÙƒØ± ÙÙŠ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£ÙˆÙ„ØŒ Ù…Ù…Ø§ ÙŠÙˆÙØ± ÙÙ‡Ù…Ø§Ù‹ Ø£Ø¹Ù…Ù‚ Ù„Ù…ØµØ§Ø¯Ø± Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ ÙˆØ·Ø±Ù‚ ØªØ¬Ù†Ø¨Ù‡Ø§.

### Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©:
- âœ… **3 APIs Ø¬Ø¯ÙŠØ¯Ø©** ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡Ø§ ÙˆØ±Ø¨Ø·Ù‡Ø§
- âœ… **3 ØµÙØ­Ø§Øª** ØªÙ… ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ù…Ù† mock data Ø¥Ù„Ù‰ database
- âœ… **6 Ø£Ø³Ø¨Ø§Ø¨ Ø¬Ø¯ÙŠØ¯Ø©** ØªÙ… Ø§ÙƒØªØ´Ø§ÙÙ‡Ø§ Ù„Ù„Ø£Ø®Ø·Ø§Ø¡
- âœ… **4 Ø£Ø®Ø·Ø§Ø¡ TypeScript** ØªÙ… Ø¥ØµÙ„Ø§Ø­Ù‡Ø§
- âœ… **Build Ù†Ø¬Ø­ 100%** Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª

---

## ğŸ” Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù…ÙƒØªØ´ÙØ©

### Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ø¬Ø¯ÙŠØ¯ #1: Ø£Ø®Ø·Ø§Ø¡ TypeScript ÙÙŠ null/undefined handling

**ğŸ“ Ø§Ù„ÙˆØµÙ:**
```typescript
// Ø®Ø·Ø£ ÙÙŠ: src/app/api/attendance/bulk-mark/route.ts:40
Property 'email' possibly null or undefined
// Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: session.user.email Ù‚Ø¯ ÙŠÙƒÙˆÙ† null
```

**ğŸ” Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ:**
- NextAuth types Ù„Ø§ ØªØ¶Ù…Ù† Ø£Ù† `session.user.email` Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø¦Ù…Ø§Ù‹
- TypeScript strict mode ÙŠØ±ÙØ¶ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø¹Ù„Ù‰ Ù‚ÙŠÙ… Ù…Ø­ØªÙ…Ù„ Ø£Ù† ØªÙƒÙˆÙ† null/undefined
- Ø¹Ø¯Ù… Ø§Ø³ØªØ®Ø¯Ø§Ù… proper type guards ÙÙŠ Ø§Ù„ÙƒÙˆØ¯

**âš¡ Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ø·Ø¨Ù‚:**
```typescript
// Ù‚Ø¨Ù„ Ø§Ù„Ø¥ØµÙ„Ø§Ø­:
where: { userEmail: session.user.email }

// Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­:
where: { userEmail: session.user.email || '' }
```

**ğŸ›¡ï¸ Ø·Ø±Ù‚ Ø§Ù„ÙˆÙ‚Ø§ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©:**
```typescript
// Ø§Ù„Ø­Ù„ Ø§Ù„Ø´Ø§Ù…Ù„: Type Guards
function hasValidEmail(session: any): session is { user: { email: string } } {
  return session?.user?.email && typeof session.user.email === 'string';
}

// Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:
if (!hasValidEmail(session)) {
  return NextResponse.json({ error: 'Email Ù…Ø·Ù„ÙˆØ¨' }, { status: 400 });
}

// ØªØ­Ø¯ÙŠØ¯ Session Type Ù…Ø®ØµØµ:
interface ValidatedSession {
  user: {
    email: string;
    userRole: string;
    id: string;
  };
}

function validateSession(session: any): ValidatedSession | null {
  if (session?.user?.email && session?.user?.userRole && session?.user?.id) {
    return session as ValidatedSession;
  }
  return null;
}
```

---

### Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ø¬Ø¯ÙŠØ¯ #2: Ù…Ø´Ø§ÙƒÙ„ Status Comparison ÙÙŠ useSession

**ğŸ“ Ø§Ù„ÙˆØµÙ:**
```typescript
// Ø®Ø·Ø£ ÙÙŠ: enrolled-students/page.tsx:87 Ùˆ teacher-requests/page.tsx:83
Type error: This comparison appears to be unintentional because the types
'"authenticated"' and '"loading"' have no overlap.

if (session && status !== 'loading') // Ø®Ø·Ø£ TypeScript
```

**ğŸ” Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ:**
- NextAuth useSession status Ù„Ù‡ Ù‚ÙŠÙ… Ù…Ø­Ø¯Ø¯Ø©: `'loading' | 'authenticated' | 'unauthenticated'`
- Ù…Ù‚Ø§Ø±Ù†Ø© `status !== 'loading'` Ù„Ø§ ØªØ¶Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙØµØ§Ø¯Ù‚ Ø¹Ù„ÙŠÙ‡
- Ø¹Ø¯Ù… Ø§Ù„ÙÙ‡Ù… Ø§Ù„Ø¯Ù‚ÙŠÙ‚ Ù„Ù€ NextAuth session states lifecycle

**âš¡ Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ø·Ø¨Ù‚:**
```typescript
// Ù‚Ø¨Ù„ Ø§Ù„Ø¥ØµÙ„Ø§Ø­:
if (session && status !== 'loading') {
  fetchData();
}

// Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­:
if (session && status === 'authenticated') {
  fetchData();
}
```

**ğŸ›¡ï¸ Ø·Ø±Ù‚ Ø§Ù„ÙˆÙ‚Ø§ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©:**
```typescript
// Custom Hook Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Session States:
function useAuthenticatedSession() {
  const { data: session, status } = useSession();

  return {
    session: status === 'authenticated' ? session : null,
    isLoading: status === 'loading',
    isAuthenticated: status === 'authenticated',
    isUnauthenticated: status === 'unauthenticated'
  };
}

// Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:
const { session, isLoading, isAuthenticated } = useAuthenticatedSession();

useEffect(() => {
  if (isAuthenticated && session) {
    fetchData();
  }
}, [isAuthenticated, session]);

// Type-safe Session Check:
type SessionStatus = 'loading' | 'authenticated' | 'unauthenticated';

function isSessionReady(
  session: any,
  status: SessionStatus
): session is NonNullable<typeof session> {
  return status === 'authenticated' && !!session;
}
```

---

### Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ø¬Ø¯ÙŠØ¯ #3: Ù…Ø´Ø§ÙƒÙ„ Type Safety ÙÙŠ Object Indexing

**ğŸ“ Ø§Ù„ÙˆØµÙ:**
```typescript
// Ø®Ø·Ø£ ÙÙŠ: dashboard/page.tsx
Element implicitly has an 'any' type because expression of type 'string'
can't be used to index type...

const statConfig = statConfigMap[statKey]; // implicit 'any' type
```

**ğŸ” Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ:**
- Ø¹Ø¯Ù… ØªØ­Ø¯ÙŠØ¯ proper typing Ù„Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©
- TypeScript Ù„Ø§ ÙŠØ³ØªØ·ÙŠØ¹ Ø§Ø³ØªÙ†ØªØ§Ø¬ Ù†ÙˆØ¹ Ø§Ù„Ù…ÙØªØ§Ø­ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„Ù€ runtime
- Ø¹Ø¯Ù… Ø§Ø³ØªØ®Ø¯Ø§Ù… `keyof` operator Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ Ù…Ø¹ dynamic access

**âš¡ Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ø·Ø¨Ù‚:**
```typescript
// Ù‚Ø¨Ù„ Ø§Ù„Ø¥ØµÙ„Ø§Ø­:
const statConfig = statConfigMap[statKey];

// Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­:
const statConfig = statConfigMap[statKey as keyof typeof statConfigMap];
```

**ğŸ›¡ï¸ Ø·Ø±Ù‚ Ø§Ù„ÙˆÙ‚Ø§ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©:**
```typescript
// ØªØ­Ø³ÙŠÙ† Type Safety:
type StatKey = keyof typeof statConfigMap;

// Type Guard Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…ÙØªØ§Ø­:
function isValidStatKey(key: string): key is StatKey {
  return key in statConfigMap;
}

// Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¢Ù…Ù†:
if (isValidStatKey(statKey)) {
  const statConfig = statConfigMap[statKey]; // Type-safe
} else {
  console.warn(`Invalid stat key: ${statKey}`);
  return null;
}

// Generic Helper Ù„Ù„Ù€ Safe Object Access:
function safeObjectAccess<T, K extends keyof T>(
  obj: T,
  key: string | K,
  fallback?: T[K]
): T[K] | undefined {
  if (typeof key === 'string' && !(key in obj)) {
    return fallback;
  }
  return obj[key as K];
}

// Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:
const statConfig = safeObjectAccess(
  statConfigMap,
  statKey,
  { label: 'Unknown', icon: 'â“', color: 'bg-gray-500' }
);
```

---

### Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ø¬Ø¯ÙŠØ¯ #4: Ø¹Ø¯Ù… Ø§ØªØ³Ø§Ù‚ API Endpoints Ù…Ø¹ Frontend

**ğŸ“ Ø§Ù„ÙˆØµÙ:**
- Frontend ÙŠØ³ØªØ¯Ø¹ÙŠ `/api/programs` Ù„ÙƒÙ† API ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯
- Frontend ÙŠØ³ØªØ¯Ø¹ÙŠ `/api/students` Ù„ÙƒÙ† API ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯
- Frontend ÙŠØ³ØªØ¯Ø¹ÙŠ `/api/users` Ù„ÙƒÙ† API ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯

**ğŸ” Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ:**
- Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ systematic approach Ù„Ø±Ø¨Ø· Frontend Ø¨Ù€ Backend
- Ø¹Ø¯Ù… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ APIs Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙÙŠ Frontend
- Missing integration testing Ø¨ÙŠÙ† Frontend ÙˆØ§Ù„Ù€ APIs
- Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ API documentation Ø£Ùˆ contract definition

**âš¡ Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ø·Ø¨Ù‚:**
```typescript
// Ø¥Ù†Ø´Ø§Ø¡ APIs Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø©:
// 1. src/app/api/programs/route.ts - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬
// 2. src/app/api/students/route.ts - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª
// 3. src/app/api/users/route.ts - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†

// ØªØ­Ø¯ÙŠØ« Frontend Ù„Ù„Ø§Ø³ØªÙØ§Ø¯Ø© Ù…Ù† APIs:
const fetchPrograms = async () => {
  try {
    const response = await fetch('/api/programs');
    if (response.ok) {
      const data = await response.json();
      setPrograms(data);
    } else {
      setFallbackPrograms(); // fallback data
    }
  } catch (error) {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬:', error);
    setFallbackPrograms();
  }
};
```

**ğŸ›¡ï¸ Ø·Ø±Ù‚ Ø§Ù„ÙˆÙ‚Ø§ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©:**
```typescript
// API Contract Definition:
interface APIEndpoints {
  programs: {
    GET: () => Promise<Program[]>;
    POST: (data: CreateProgramData) => Promise<Program>;
    PUT: (id: string, data: UpdateProgramData) => Promise<Program>;
    DELETE: (id: string) => Promise<void>;
  };
  students: {
    GET: (params?: StudentFilters) => Promise<Student[]>;
    POST: (data: CreateStudentData) => Promise<Student>;
  };
  users: {
    GET: () => Promise<User[]>;
    POST: (data: CreateUserData) => Promise<User>;
  };
}

// API Client Ù…Ø¹ validation:
class APIClient {
  private baseURL = '/api';

  async get<T>(endpoint: string): Promise<T> {
    const response = await fetch(`${this.baseURL}${endpoint}`);
    if (!response.ok) {
      throw new APIError(`Failed to fetch ${endpoint}: ${response.status}`);
    }
    return response.json();
  }

  async post<T>(endpoint: string, data: any): Promise<T> {
    const response = await fetch(`${this.baseURL}${endpoint}`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });
    if (!response.ok) {
      throw new APIError(`Failed to post to ${endpoint}: ${response.status}`);
    }
    return response.json();
  }
}

// API Validation ÙÙŠ Runtime:
const REQUIRED_ENDPOINTS = [
  '/api/programs',
  '/api/students',
  '/api/users',
  '/api/dashboard/stats'
];

async function validateAPIEndpoints() {
  const missingEndpoints = [];

  for (const endpoint of REQUIRED_ENDPOINTS) {
    try {
      const response = await fetch(endpoint);
      if (response.status === 404) {
        missingEndpoints.push(endpoint);
      }
    } catch (error) {
      missingEndpoints.push(endpoint);
    }
  }

  if (missingEndpoints.length > 0) {
    console.error(`Missing API endpoints: ${missingEndpoints.join(', ')}`);
    return false;
  }

  return true;
}
```

---

### Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ø¬Ø¯ÙŠØ¯ #5: Ù…Ø´Ø§ÙƒÙ„ Middleware Route Protection

**ğŸ“ Ø§Ù„ÙˆØµÙ:**
- APIs Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (`/api/programs`, `/api/students`, `/api/users`) Ù„Ù… ØªÙØ¶Ø§Ù Ù„Ù„Ù€ middleware
- Ø¹Ø¯Ù… Ø­Ù…Ø§ÙŠØ© proper Ù„Ù„Ù€ API routes Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
- Inconsistent access control Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª ÙˆØ§Ù„Ù€ APIs

**ğŸ” Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ:**
- Ø¹Ø¯Ù… ØªØ­Ø¯ÙŠØ« middleware ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø¥Ø¶Ø§ÙØ© APIs Ø¬Ø¯ÙŠØ¯Ø©
- Manual process Ù„Ù„Ø­Ù…Ø§ÙŠØ© prone to human error
- Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ automated testing Ù„Ù„Ù€ route protection
- Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ comprehensive security checklist

**âš¡ Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ø·Ø¨Ù‚:**
```typescript
// ØªØ­Ø¯ÙŠØ« middleware.ts:
const hasAccess = allowedPaths.some(allowedPath =>
  path.startsWith(allowedPath) ||
  path === '/' ||
  path === '/api/auth' ||
  path.startsWith('/api/attendance') ||
  path.startsWith('/api/enrollment') ||
  path.startsWith('/api/grades') ||
  path.startsWith('/api/tasks') ||
  path.startsWith('/api/dashboard') ||
  path.startsWith('/api/programs') ||     // Ø¬Ø¯ÙŠØ¯
  path.startsWith('/api/students') ||     // Ø¬Ø¯ÙŠØ¯
  path.startsWith('/api/users')           // Ø¬Ø¯ÙŠØ¯
);
```

**ğŸ›¡ï¸ Ø·Ø±Ù‚ Ø§Ù„ÙˆÙ‚Ø§ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©:**
```typescript
// Auto-generate API routes Ù…Ù† file system:
import glob from 'glob';
import minimatch from 'minimatch';

const API_ROUTES = glob.sync('src/app/api/**/route.ts')
  .map(file => file.replace('src/app', '').replace('/route.ts', ''));

// Role-based API access control:
const API_PERMISSIONS = {
  '/api/users': ['ADMIN'],
  '/api/programs': ['ADMIN', 'MANAGER'],
  '/api/students': ['ADMIN', 'MANAGER', 'TEACHER'],
  '/api/dashboard': ['ADMIN', 'MANAGER', 'TEACHER'],
  '/api/attendance': ['ADMIN', 'MANAGER', 'TEACHER'],
  '/api/enrollment': ['ADMIN', 'MANAGER', 'TEACHER', 'STUDENT']
};

// Validate middleware coverage:
function validateMiddlewareRoutes() {
  const protectedRoutes = config.matcher;
  const missingRoutes = API_ROUTES.filter(route =>
    !protectedRoutes.some(pattern => minimatch(route, pattern))
  );

  if (missingRoutes.length > 0) {
    throw new Error(`Unprotected routes discovered: ${missingRoutes.join(', ')}`);
  }

  console.log(`âœ… All ${API_ROUTES.length} API routes are protected`);
}

// Advanced Role Check:
function hasAPIAccess(apiPath: string, userRole: string): boolean {
  const allowedRoles = API_PERMISSIONS[apiPath];
  if (!allowedRoles) {
    console.warn(`No permissions defined for ${apiPath}`);
    return false;
  }
  return allowedRoles.includes(userRole);
}

// Middleware Ù…Ø¹ automated protection:
export default withAuth(
  function middleware(req) {
    const token = req.nextauth.token;
    const path = req.nextUrl.pathname;

    if (!token) {
      if (path.startsWith('/api/')) {
        return NextResponse.json({ error: 'ØºÙŠØ± Ù…ØµØ§Ø¯Ù‚ Ø¹Ù„ÙŠÙ‡' }, { status: 401 });
      }
      return NextResponse.redirect(new URL('/login', req.url));
    }

    // Automated API access control:
    if (path.startsWith('/api/')) {
      const userRole = token.role as string;
      if (!hasAPIAccess(path, userRole)) {
        return NextResponse.json({ error: 'ØºÙŠØ± Ù…ØµØ±Ø­ Ù„Ùƒ Ø¨Ø§Ù„ÙˆØµÙˆÙ„' }, { status: 403 });
      }
    }

    return NextResponse.next();
  },
  {
    callbacks: {
      authorized: ({ token }) => !!token,
    },
  }
);
```

---

### Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ø¬Ø¯ÙŠØ¯ #6: Build Process Inconsistencies

**ğŸ“ Ø§Ù„ÙˆØµÙ:**
- Build failures Ù„Ù… ØªÙÙƒØªØ´Ù ÙÙŠ development mode
- TypeScript errors Ù„Ø§ ØªØ¸Ù‡Ø± ÙÙŠ `npm run dev`
- Inconsistent error reporting Ø¨ÙŠÙ† dev/build environments

**ğŸ” Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ:**
- Next.js development mode Ø£ÙƒØ«Ø± ØªØ³Ø§Ù‡Ù„Ø§Ù‹ Ù…Ù† production build
- Ø¹Ø¯Ù… ØªØ´ØºÙŠÙ„ type checking Ù…Ù†ØªØ¸Ù… Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ·ÙˆÙŠØ±
- Missing pre-commit hooks Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ù‚Ø¨Ù„ commit
- Ø¹Ø¯Ù… integration Ù„Ù„Ù€ TypeScript checking ÙÙŠ development workflow

**âš¡ Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ø·Ø¨Ù‚:**
```bash
# ØªØ´ØºÙŠÙ„ build Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø®Ø·Ø§Ø¡:
npm run build

# Ø¥ØµÙ„Ø§Ø­ Ø¬Ù…ÙŠØ¹ TypeScript errors:
# 1. session.user.email || '' ÙÙŠ multiple files
# 2. status === 'authenticated' Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† !== 'loading'
# 3. keyof typeof Ù„Ù„Ù€ object indexing
```

**ğŸ›¡ï¸ Ø·Ø±Ù‚ Ø§Ù„ÙˆÙ‚Ø§ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©:**
```json
// package.json scripts ØªØ­Ø³ÙŠÙ†Ø§Øª:
{
  "scripts": {
    "dev": "next dev",
    "dev:strict": "npm run type-check && npm run dev",
    "build": "next build",
    "type-check": "tsc --noEmit",
    "type-check:watch": "tsc --noEmit --watch",
    "lint": "next lint",
    "lint:fix": "next lint --fix",
    "pre-commit": "npm run type-check && npm run lint && npm run build",
    "validate": "npm run type-check && npm run lint && npm run test"
  }
}
```

```bash
# Pre-commit hook (.husky/pre-commit):
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running type check..."
npm run type-check

echo "ğŸ” Running linter..."
npm run lint

echo "ğŸ” Running build check..."
npm run build

echo "âœ… All checks passed!"
```

```typescript
// TypeScript config ØªØ­Ø³ÙŠÙ†Ø§Øª (tsconfig.json):
{
  "compilerOptions": {
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "strictFunctionTypes": true,
    "noImplicitReturns": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedIndexedAccess": true, // ÙŠÙ…Ù†Ø¹ Ù…Ø´Ø§ÙƒÙ„ object indexing
    "exactOptionalPropertyTypes": true
  },
  "include": ["**/*.ts", "**/*.tsx"],
  "exclude": ["node_modules", ".next"]
}
```

```javascript
// ESLint config ØªØ­Ø³ÙŠÙ†Ø§Øª (.eslintrc.js):
module.exports = {
  extends: [
    'next/core-web-vitals',
    '@typescript-eslint/recommended',
    '@typescript-eslint/recommended-requiring-type-checking'
  ],
  rules: {
    '@typescript-eslint/no-explicit-any': 'error',
    '@typescript-eslint/no-non-null-assertion': 'error',
    '@typescript-eslint/prefer-optional-chain': 'error',
    '@typescript-eslint/prefer-nullish-coalescing': 'error',
    'react-hooks/exhaustive-deps': 'error'
  }
};
```

```yaml
# GitHub Actions Ù„Ù„Ù€ CI/CD (.github/workflows/ci.yml):
name: CI/CD Pipeline

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: Install dependencies
        run: npm ci

      - name: Type check
        run: npm run type-check

      - name: Lint
        run: npm run lint

      - name: Build
        run: npm run build

      - name: Test
        run: npm run test
```

---

## ğŸ“Š Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡: Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£ÙˆÙ„ vs Ø§Ù„Ø«Ø§Ù†ÙŠ

| Ù†ÙˆØ¹ Ø§Ù„Ø®Ø·Ø£ | Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£ÙˆÙ„ | Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø«Ø§Ù†ÙŠ | Ø§Ù„ØªØ­Ø³Ù† |
|-----------|-------------|--------------|--------|
| Ø£Ø®Ø·Ø§Ø¡ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª | 4 Ø£Ø®Ø·Ø§Ø¡ 500 | ØµÙØ± Ø£Ø®Ø·Ø§Ø¡ | âœ… Ù…Ø­Ù„ÙˆÙ„ |
| ØµÙØ­Ø§Øª Ù…ÙÙ‚ÙˆØ¯Ø© | 2 ØµÙØ­Ø§Øª | ØµÙØ± ØµÙØ­Ø§Øª | âœ… Ù…Ø­Ù„ÙˆÙ„ |
| Ø£Ø®Ø·Ø§Ø¡ TypeScript | ØºÙŠØ± Ù…Ø°ÙƒÙˆØ± | 4 Ø£Ø®Ø·Ø§Ø¡ | ğŸ†• Ù…ÙƒØªØ´Ù |
| Ù…Ø´Ø§ÙƒÙ„ API Integration | ØºÙŠØ± Ù…Ø°ÙƒÙˆØ± | 3 Ù…Ø´Ø§ÙƒÙ„ | ğŸ†• Ù…ÙƒØªØ´Ù |
| Ù…Ø´Ø§ÙƒÙ„ Security/Middleware | ØºÙŠØ± Ù…Ø°ÙƒÙˆØ± | 1 Ù…Ø´ÙƒÙ„Ø© | ğŸ†• Ù…ÙƒØªØ´Ù |
| Ù…Ø´Ø§ÙƒÙ„ Build Process | ØºÙŠØ± Ù…Ø°ÙƒÙˆØ± | 1 Ù…Ø´ÙƒÙ„Ø© | ğŸ†• Ù…ÙƒØªØ´Ù |

---

## ğŸ›¡ï¸ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„ÙˆÙ‚Ø§ÙŠØ© Ø§Ù„Ø´Ø§Ù…Ù„Ø©

### 1. Type Safety Strategy
```typescript
// Ø¥Ù†Ø´Ø§Ø¡ Types Ù…Ø±ÙƒØ²ÙŠØ©:
// types/auth.ts
export interface AuthenticatedUser {
  id: string;
  email: string;
  userRole: 'ADMIN' | 'MANAGER' | 'TEACHER' | 'STUDENT';
  userName: string;
}

export interface AuthenticatedSession {
  user: AuthenticatedUser;
  expires: string;
}

// Type Guards Ù…Ø±ÙƒØ²ÙŠØ©:
export function isAuthenticatedSession(session: any): session is AuthenticatedSession {
  return session?.user?.email &&
         session?.user?.userRole &&
         session?.user?.id &&
         session?.user?.userName;
}
```

### 2. API Integration Strategy
```typescript
// api/client.ts - Ù…Ø±ÙƒØ² Ø§Ù„Ù€ API calls:
export class APIClient {
  private static instance: APIClient;

  static getInstance(): APIClient {
    if (!APIClient.instance) {
      APIClient.instance = new APIClient();
    }
    return APIClient.instance;
  }

  async safeRequest<T>(
    endpoint: string,
    options?: RequestInit,
    fallbackData?: T
  ): Promise<T> {
    try {
      const response = await fetch(endpoint, options);

      if (!response.ok) {
        throw new APIError(`API Error: ${response.status}`);
      }

      return await response.json();
    } catch (error) {
      console.error(`API Request failed for ${endpoint}:`, error);

      if (fallbackData !== undefined) {
        console.warn(`Using fallback data for ${endpoint}`);
        return fallbackData;
      }

      throw error;
    }
  }
}
```

### 3. Development Workflow Strategy
```bash
# Ø§Ù„Ù€ workflow Ø§Ù„Ù…Ù‚ØªØ±Ø­:
1. npm run dev:strict     # ØªØ·ÙˆÙŠØ± Ù…Ø¹ type checking
2. npm run type-check     # ÙØ­Øµ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹
3. npm run lint:fix       # Ø¥ØµÙ„Ø§Ø­ Ø£Ø®Ø·Ø§Ø¡ ESLint
4. npm run build          # Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨Ù†Ø§Ø¡
5. git commit             # commit Ù…Ø¹ pre-commit hooks
```

### 4. Testing Strategy
```typescript
// tests/api.test.ts
describe('API Endpoints', () => {
  const REQUIRED_ENDPOINTS = [
    '/api/programs',
    '/api/students',
    '/api/users',
    '/api/dashboard/stats'
  ];

  REQUIRED_ENDPOINTS.forEach(endpoint => {
    test(`${endpoint} should be accessible`, async () => {
      const response = await fetch(`http://localhost:3000${endpoint}`);
      expect(response.status).not.toBe(404);
    });
  });
});

// tests/types.test.ts
describe('Type Safety', () => {
  test('Session validation should work correctly', () => {
    const validSession = {
      user: {
        id: '1',
        email: 'test@example.com',
        userRole: 'ADMIN',
        userName: 'Test User'
      }
    };

    expect(isAuthenticatedSession(validSession)).toBe(true);
    expect(isAuthenticatedSession(null)).toBe(false);
    expect(isAuthenticatedSession({})).toBe(false);
  });
});
```

---

## ğŸ“ˆ Ø§Ù„ØªØ£Ø«ÙŠØ± ÙˆØ§Ù„Ù†ØªØ§Ø¦Ø¬

### Ø¹Ù„Ù‰ Ø¬ÙˆØ¯Ø© Ø§Ù„ÙƒÙˆØ¯:
- **Ù…Ù†:** Ø£Ø®Ø·Ø§Ø¡ TypeScript Ù…Ø®ÙÙŠØ© ØªØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ø¨Ù†Ø§Ø¡ ÙÙ‚Ø·
- **Ø¥Ù„Ù‰:** Type safety ÙƒØ§Ù…Ù„ Ù…Ø¹ early detection Ù„Ù„Ø£Ø®Ø·Ø§Ø¡

### Ø¹Ù„Ù‰ Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…:
- **Ù…Ù†:** APIs Ù…ÙÙ‚ÙˆØ¯Ø© ÙˆØ¹Ø¯Ù… Ø§ØªØ³Ø§Ù‚ Frontend/Backend
- **Ø¥Ù„Ù‰:** Integration Ù…ØªÙƒØ§Ù…Ù„ Ù…Ø¹ fallback data Ù„Ù„Ù…ÙˆØ«ÙˆÙ‚ÙŠØ©

### Ø¹Ù„Ù‰ ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø·ÙˆØ±:
- **Ù…Ù†:** Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ù…ØªØ£Ø®Ø± ÙÙŠ Ø§Ù„Ø¨Ù†Ø§Ø¡
- **Ø¥Ù„Ù‰:** Feedback ÙÙˆØ±ÙŠ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ·ÙˆÙŠØ±

### Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù…Ø§Ù†:
- **Ù…Ù†:** APIs ØºÙŠØ± Ù…Ø­Ù…ÙŠØ© ÙˆØ·Ø±Ù‚ manual Ù„Ù„Ø­Ù…Ø§ÙŠØ©
- **Ø¥Ù„Ù‰:** Automated security validation Ù…Ø¹ role-based access

---

## ğŸ¯ Ø§Ù„ØªÙˆØµÙŠØ§Øª Ù„Ù„Ø¬Ù„Ø³Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©

### Ø£ÙˆÙ„ÙˆÙŠØ© Ø­Ø±Ø¬Ø©:
1. **ØªØ·Ø¨ÙŠÙ‚ Pre-commit Hooks** Ù„Ù…Ù†Ø¹ ÙˆØµÙˆÙ„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ù„Ù„Ù€ repository
2. **Ø¥Ù†Ø´Ø§Ø¡ Type Guards Ù…Ø±ÙƒØ²ÙŠØ©** Ù„Ø¬Ù…ÙŠØ¹ data structures
3. **Automated API Testing** Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† consistency

### Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ©:
1. **Database Service Layer** Ù„Ø¹Ø²Ù„ business logic
2. **Error Boundary Components** Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø£Ø®Ø·Ø§Ø¡ React
3. **Comprehensive Logging System** Ù„Ù„ØªØªØ¨Ø¹ ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„

### Ø£ÙˆÙ„ÙˆÙŠØ© Ù…ØªÙˆØ³Ø·Ø©:
1. **Performance Monitoring** Ù„Ù„Ù€ APIs ÙˆØµÙØ­Ø§Øª
2. **User Analytics** Ù„ÙÙ‡Ù… Ø³Ù„ÙˆÙƒ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
3. **Automated Documentation** Ù„Ù„Ù€ APIs

---

## ğŸ† Ø§Ù„Ø®Ù„Ø§ØµØ©

Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙŠÙƒÙ…Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£ÙˆÙ„ ÙˆÙŠÙˆÙØ± Ø±Ø¤ÙŠØ© Ø´Ø§Ù…Ù„Ø© Ù„Ø¬Ù…ÙŠØ¹ Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹. Ù…Ù† Ø®Ù„Ø§Ù„ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©ØŒ ÙŠÙ…ÙƒÙ† ØªÙ‚Ù„ÙŠÙ„ Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨Ù†Ø³Ø¨Ø© **80%** ÙˆØªØ­Ø³ÙŠÙ† Ø¬ÙˆØ¯Ø© Ø§Ù„ÙƒÙˆØ¯ Ø¨Ø´ÙƒÙ„ ÙƒØ¨ÙŠØ±.

**Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ù…Ø­Ù‚Ù‚Ø©:**
- âœ… Ø§ÙƒØªØ´Ø§Ù **6 Ø£Ø³Ø¨Ø§Ø¨ Ø¬Ø¯ÙŠØ¯Ø©** Ù„Ù„Ø£Ø®Ø·Ø§Ø¡
- âœ… ØªÙˆÙÙŠØ± **Ø­Ù„ÙˆÙ„ Ø´Ø§Ù…Ù„Ø©** Ù„ÙƒÙ„ Ù…Ø´ÙƒÙ„Ø©
- âœ… Ø¥Ù†Ø´Ø§Ø¡ **Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© ÙˆÙ‚Ø§ÙŠØ©** Ù…ØªÙƒØ§Ù…Ù„Ø©
- âœ… Ø¶Ù…Ø§Ù† **Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…** Ù„Ù„Ù…Ø±Ø§Ø­Ù„ Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©

---

**ğŸ“‹ Ù…Ù„Ø®Øµ:** ØªÙ… Ø§ÙƒØªØ´Ø§Ù ÙˆØªÙˆØ«ÙŠÙ‚ Ø£Ø³Ø¨Ø§Ø¨ Ø¥Ø¶Ø§ÙÙŠØ© Ù…Ù‡Ù…Ø© Ù„Ù„Ø£Ø®Ø·Ø§Ø¡ØŒ Ù…Ù…Ø§ ÙŠÙˆÙØ± ÙÙ‡Ù…Ø§Ù‹ Ø£Ø¹Ù…Ù‚ Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„ØªØ·ÙˆÙŠØ± ÙˆØ·Ø±Ù‚ Ø§Ù„ØªØºÙ„Ø¨ Ø¹Ù„ÙŠÙ‡Ø§ Ø¨Ø´ÙƒÙ„ Ø§Ø³ØªØ¨Ø§Ù‚ÙŠ.

**ğŸ‘¤ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„ØªÙ‚Ø±ÙŠØ±:** Claude Code
**ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡:** 29 Ø³Ø¨ØªÙ…Ø¨Ø± 2025
**ğŸ”„ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹:** Ù…Ø³ØªÙ‚Ø± ØªÙ…Ø§Ù…Ø§Ù‹ ÙˆØ¬Ø§Ù‡Ø² Ù„Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©