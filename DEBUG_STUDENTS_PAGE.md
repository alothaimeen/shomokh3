# ๐ง ูููุฉ ุฅุตูุงุญ ูุดุงูู ุงูุตูุงุญูุงุช ูุงููุตูู - Debugging Task

## ๐ ุงูุณูุงู
ููุตุฉ ุดููุฎ v3 - ูุธุงู ุฅุฏุงุฑุฉ ุชุนููู ูุฑุขูู ุจุซูุงุซุฉ ุฃุฏูุงุฑ: ADMIN, TEACHER, STUDENT  
ุงูุชูููุงุช: Next.js 15 App Router, NextAuth.js, Prisma, Supabase PostgreSQL

## ๐ ุงููุดููุฉ ุงูุฑุฆูุณูุฉ
**ุตูุญุฉ `/students` ูุง ูููู ููุฃุฏูู ุงูุฏุฎูู ุฅูููุง** - ูุชู ุชุญูููู ูุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู ุฑุบู ุฃูู ูุณุฌู ุฏุฎูู ุจุงููุนู.

### ุงูุฃุนุฑุงุถ ุงูููุตูุฉ:
```
GET /api/auth/signin?callbackUrl=%2Fstudents 302
GET /login?callbackUrl=http%3A%2F%2Flocalhost%3A3000%2Fstudents 200
```
ุงููุธุงู ูุนุชูุฏ ุฃู ุงูุฃุฏูู ุบูุฑ ูุตุฑุญ ูู ุจุงูุฏุฎูู ููุตูุญุฉ.

---

## ๐ ุงููููุงุช ุงููุทููุจ ูุฑุงุกุชูุง ููุญุตูุง:

### 1. ูููุงุช ุงูุตูุงุญูุงุช ูุงูุชูุฌูู (Authorization & Routing)
```
src/middleware.ts           # ุงูุชุญูู ูู ุงูุตูุงุญูุงุช ุนูู ูุณุชูู ุงููุธุงู
src/lib/auth.ts            # ุฅุนุฏุงุฏุงุช NextAuth.js
src/app/students/page.tsx  # ุงูุตูุญุฉ ุงููุณุชูุฏูุฉ ุงูุชู ูุง ุชุนูู
```

### 2. ูููุงุช ุงูุณูุงู ูุงูุชูุซูู
```
.github/copilot-instructions.md    # ููุงุนุฏ ุงููุธุงู ูุงูุฃููุงุท ุงููุชุจุนุฉ
PROJECT_TIMELINE.md                # ุงูุญุงูุฉ ุงูุญุงููุฉ ูููุดุฑูุน
prisma/schema.prisma               # ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช (User, Student, Role)
```

### 3. ูููุงุช ูุดุงุจูุฉ ููููุงุฑูุฉ (ุชุนูู ุจูุฌุงุญ)
```
src/app/users/page.tsx             # ุตูุญุฉ ูุดุงุจูุฉ ุชุนูู ููุฃุฏูู
src/app/programs/page.tsx          # ุตูุญุฉ ุฃุฎุฑู ุชุนูู ููุฃุฏูู
src/app/teacher-requests/page.tsx  # ุชู ุฅุตูุงุญูุง ูุคุฎุฑุงู
```

---

## ๐ ุฎุทูุงุช ุงูุชุดุฎูุต ุงููุทููุจุฉ:

### ุงููุฑุญูุฉ 1: ููู ุขููุฉ ุงูุตูุงุญูุงุช
1. ุงูุฑุฃ `src/middleware.ts` ูุญุฏุฏ:
   - ูุง ูู ุงููุณุงุฑุงุช ุงููุญููุฉุ
   - ููู ูุชู ุงูุชุญูู ูู ุงูุตูุงุญูุงุชุ
   - ูู `/students` ููุฌูุฏ ูู ุงููุงุฆูุฉุ

2. ุงูุฑุฃ `src/lib/auth.ts` ูุชุญูู ูู:
   - ุจููุฉ `token.role` ูู JWT
   - ููู ูุชู ุชุฎุฒูู ุงูุฏูุฑ ูู session

3. ุงูุฑุฃ `src/app/students/page.tsx` ูุงูุญุต:
   - ุดุฑุท `auth()` ูู ุงูุตูุญุฉ
   - ูู ูุชุทุงุจู ูุน Middlewareุ
   - ูู ููุงู ุชูุงูุถ ูู ุงูุดุฑูุทุ

### ุงููุฑุญูุฉ 2: ุงูููุงุฑูุฉ ูุน ุงูุตูุญุงุช ุงููุงุฌุญุฉ
4. ูุงุฑู `/students/page.tsx` ูุน `/users/page.tsx`:
   - ูุง ุงููุฑู ูู ุดุฑูุท ุงูุชุญููุ
   - ูู ููุงู ุงุฎุชูุงู ูู ุงุณุชุฎุฏุงู `session.user.role`ุ

5. ุงูุญุต `/teacher-requests/page.tsx` (ุชู ุฅุตูุงุญูุง):
   - ูุง ุงูุฐู ุชู ุชุบููุฑู ูุญู ุงููุดููุฉุ
   - ูู ููุณ ุงูุฅุตูุงุญ ููุทุจู ุนูู `/students`ุ

### ุงููุฑุญูุฉ 3: ูุญุต ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูู Schema
6. ุงูุญุต `prisma/schema.prisma`:
   - ุชุฃูุฏ ูู ูุฌูุฏ enum UserRole
   - ูู ADMIN ููุฌูุฏ ูููุ

7. ุชุญูู ูู ุณุฌูุงุช Console ูู Terminal:
   ```
   GET /students - ูุง ูู status codeุ
   GET /api/auth/session - ูู ูุฑุฌุน session ุตุญูุญุ
   ```

---

## โ ูุนุงููุฑ ุงููุฌุงุญ:

1. **ุตูุญุฉ `/students` ุชูุชุญ ุจูุฌุงุญ ููุฃุฏูู** ุจุฏูู redirect
2. **ูุง ููุฌุฏ ุชุณุฌูู ุฎุฑูุฌ ุชููุงุฆู**
3. **Middleware ูุณูุญ ุจุงููุตูู ููุฃุฏูู ููุท**
4. **ุงูุตูุญุฉ ุชุญูู ููุณูุง ูู TEACHER ู STUDENT**
5. **Build ููุฌุญ ุจุฏูู TypeScript errors**

---

## ๐๏ธ ุงูุญู ุงููุชููุน:

ุจุนุฏ ูุฑุงุกุฉ ุงููููุงุชุ ูู ุงููุญุชูู ุฃู ุงููุดููุฉ ูู ุฃุญุฏ ุงูุฃูุงูู ุงูุชุงููุฉ:

### ุงุญุชูุงู 1: Middleware ูุง ูุดูู `/students`
```typescript
// ูู src/middleware.ts
if (path.startsWith('/programs') || path.startsWith('/users')) {
  return token.role === 'ADMIN';
}
// โ ูุณูุงู ุฅุถุงูุฉ /students
```

**ุงูุญู:** ุฅุถุงูุฉ `/students` ููุดุฑุท

### ุงุญุชูุงู 2: ุงูุตูุญุฉ ุชุณูุญ ููู TEACHER ุฃูุถุงู
```typescript
// ูู src/app/students/page.tsx
if (!session?.user || !['ADMIN', 'TEACHER'].includes(session.user.role)) {
  redirect('/dashboard');
}
// โ ุฎุทุฃ: ุงูุตูุญุฉ ููุฃุฏูู ููุท
```

**ุงูุญู:** ุชุบููุฑ ุงูุดุฑุท ุฅูู:
```typescript
if (!session?.user || session.user.role !== 'ADMIN') {
  redirect('/dashboard');
}
```

### ุงุญุชูุงู 3: ุชูุงูุถ ุจูู Middleware ูุงูุตูุญุฉ
```typescript
// Middleware ูุณูุญ ููุฃุฏูู ูุงููุนููุฉ
// ููู ุงูุตูุญุฉ ุชุฑูุถ ุงูุงุซููู!
```

**ุงูุญู:** ุชูุญูุฏ ุงูุดุฑูุท

---

## ๐ ุงูุชุนูููุงุช ููุฐูุงุก ุงูุงุตุทูุงุนู:

1. **ุงูุฑุฃ ุฌููุน ุงููููุงุช ุงููุฐููุฑุฉ ุฃุนูุงู ุจุงูุชุฑุชูุจ**
2. **ุญูู ุงููุดููุฉ ุจูุงุกู ุนูู ุงูุฃุนุฑุงุถ**
3. **ุญุฏุฏ ุงูุณุจุจ ุงูุฌุฐุฑู ุจุฏูุฉ**
4. **ูุฏู ุงูุญู ุงูุฃูุซู (ููุฏ ุฌุงูุฒ ููุชุทุจูู)**
5. **ุชุฃูุฏ ูู ุนุฏู ูุณุฑ ุงูุตูุญุงุช ุงูุฃุฎุฑู**
6. **ุงุฎุชุจุฑ ุงูุญู ุฐูููุงู ูุจู ุงูุชุทุจูู**

---

## โ๏ธ ุชุญุฐูุฑุงุช ูููุฉ:

- โ **ูุง ุชุญูู ุงูุตูุญุฉ ูู Server ุฅูู Client Component**
- โ **ูุง ุชุบูุฑ ูููู auth() ุฃู getServerSession()**
- โ **ูุง ุชูุณ ูุธุงู NextAuth ุจุฏูู ุถุฑูุฑุฉ**
- โ **ุฑูุฒ ุนูู ุงูุดุฑูุท ุงูููุทููุฉ ููุท**
- โ **ุชุฃูุฏ ูู ุงูุงุชุณุงู ุจูู Middleware ูุงูุตูุญุฉ**

---

## ๐ฏ ุงููุฏู ุงูููุงุฆู:
**ุฃู ูุณุชุทูุน ุงููุฏูุฑ (ADMIN) ุงูุฏุฎูู ูุตูุญุฉ `/students` ูุงูุชุนุฏูู ุนูู ุจูุงูุงุช ุงูุทุงูุจุงุช ุจูุฌุงุญุ ุจูููุง ููููุน ุงููุนููุงุช ูุงูุทุงูุจุงุช ูู ุงูุฏุฎูู.**
